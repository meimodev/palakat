# Implementation Plan

- [x] 1. Set up localization infrastructure in shared package
  - [x] 1.1 Create l10n directory structure and configuration
    - Create `packages/palakat_shared/lib/l10n/` directory
    - Create `l10n.yaml` configuration file with ARB settings
    - Update `pubspec.yaml` to enable Flutter generate
    - _Requirements: 2.1, 2.2, 2.4_
  - [x] 1.2 Create comprehensive ARB files with ALL translations centralized
    - Create `intl_id.arb` with Indonesian translations (template) - ALL strings in one file
    - Create `intl_en.arb` with English translations - ALL strings in one file
    - Organize keys by category using prefixes: `nav_`, `btn_`, `lbl_`, `err_`, `status_`, `auth_`, `dashboard_`, etc.
    - Include: navigation labels, buttons, form labels/hints, error messages, status labels, auth strings, dashboard strings
    - This single source of truth ensures consistency and easy maintenance
    - _Requirements: 2.1, 2.3, 4.1, 4.2, 4.3, 4.4, 4.5_
  - [x] 1.3 Implement LocaleSerializer utility class
    - Create `locale_serializer.dart` with serialize/deserialize methods
    - Add supported locales constant and validation
    - _Requirements: 7.1, 7.2_
  - [x] 1.4 Write property test for locale round-trip
    - **Property 1: Locale Round-Trip Consistency**
    - **Validates: Requirements 7.1, 7.2, 7.3**

- [x] 2. Implement locale persistence service
  - [x] 2.1 Create LocaleService class
    - Implement `saveLocale()` method using Hive
    - Implement `loadLocale()` method with null handling
    - Implement `clearLocale()` method
    - Add to `LocalStorageService` or create separate service
    - _Requirements: 1.5, 1.6, 5.4_
  - [x] 2.2 Add locale storage key constant
    - Define `_kLocaleKey` constant for Hive storage
    - _Requirements: 5.5_
  - [x] 2.3 Write property test for locale persistence
    - **Property 2: Locale Persistence Consistency**
    - **Validates: Requirements 1.5, 1.6, 5.4**

- [x] 3. Implement LocaleController with Riverpod
  - [x] 3.1 Create LocaleController StateNotifier
    - Create `locale_controller.dart` with Riverpod annotations
    - Implement `build()` method with default Indonesian locale
    - Implement `setLocale()` method with persistence
    - Implement `_loadPersistedLocale()` for initialization
    - _Requirements: 5.1, 5.2, 5.3, 5.4_
  - [x] 3.2 Create localeControllerProvider
    - Export provider from shared package services
    - _Requirements: 5.1_
  - [x] 3.3 Write property test for locale change notification
    - **Property 3: Locale Change Notification**
    - **Validates: Requirements 1.4, 5.1**

- [x] 4. Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.

- [x] 5. Create LanguageSelector widget
  - [x] 5.1 Create LanguageOption model
    - Create freezed model with locale, name, and flag fields
    - Define static list of supported language options
    - _Requirements: 6.3_
  - [x] 5.2 Implement LanguageSelector widget
    - Create dropdown/dialog for language selection
    - Display current language with flag
    - Show available options on tap
    - Call LocaleController.setLocale on selection
    - _Requirements: 6.3, 6.4_
  - [x] 5.3 Write unit tests for LanguageSelector
    - Test widget displays current language
    - Test options are shown on tap
    - Test selection triggers locale change
    - _Requirements: 6.3, 6.4_

- [x] 6. Integrate localization in Palakat Mobile
  - [x] 6.1 Configure MaterialApp with localization
    - Add localizationsDelegates to MaterialApp.router
    - Add supportedLocales configuration
    - Bind locale to localeControllerProvider
    - _Requirements: 1.1, 1.4_
  - [x] 6.2 Add LanguageSelector to account screen
    - Import LanguageSelector widget
    - Add to account/settings screen UI
    - _Requirements: 6.1_
  - [x] 6.3 Create BuildContext extension for l10n access
    - Create `context.l10n` extension method
    - _Requirements: 3.1_

- [x] 7. Integrate localization in Palakat Admin
  - [x] 7.1 Configure MaterialApp with localization
    - Add localizationsDelegates to MaterialApp.router
    - Add supportedLocales configuration
    - Bind locale to localeControllerProvider
    - _Requirements: 1.2, 1.4_
  - [x] 7.2 Add LanguageSelector to account screen
    - Import LanguageSelector widget
    - Add to account screen UI
    - _Requirements: 6.2_
  - [x] 7.3 Create BuildContext extension for l10n access
    - Create `context.l10n` extension method (or reuse from shared)
    - _Requirements: 3.1_

- [x] 8. Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.

- [x] 9. Add locale-aware formatting utilities
  - [x] 9.1 Create DateFormatter utility
    - Implement locale-aware date formatting methods
    - Support common date patterns (short, medium, long)
    - _Requirements: 3.4, 4.6_
  - [x] 9.2 Create NumberFormatter utility
    - Implement locale-aware number formatting
    - Support currency formatting for Indonesian Rupiah
    - _Requirements: 3.5_
  - [x] 9.3 Write property test for date formatting
    - **Property 4: Date Formatting Locale Awareness**
    - **Validates: Requirements 3.4, 4.6**
  - [x] 9.4 Write property test for number formatting
    - **Property 5: Number Formatting Locale Awareness**
    - **Validates: Requirements 3.5**

- [x] 10. Update widgets to use centralized translations - Shared Package
  - [x] 10.1 Update error widgets to use l10n
    - Update CompactErrorWidget to use `context.l10n.err_*` keys
    - All error strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.4_
  - [x] 10.2 Update status widgets to use l10n
    - Update StatusChip and related widgets to use `context.l10n.status_*` keys
    - All status strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.5_
  - [x] 10.3 Update sidebar to use l10n
    - Update AppSidebar widget to use `context.l10n.nav_*` keys
    - All navigation strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.1_

- [x] 11. Update widgets to use centralized translations - Palakat Admin
  - [x] 11.1 Update dashboard screen to use l10n
    - Update DashboardScreen widget to use `context.l10n.dashboard_*` keys
    - All dashboard strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.1, 4.2, 4.3_
  - [x] 11.2 Update auth screen to use l10n
    - Update SignInScreen widget to use `context.l10n.auth_*` keys
    - All auth strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.2, 4.3_
  - [x] 11.3 Update common UI to use l10n
    - Update AppScaffold and related widgets to use `context.l10n.btn_*`, `context.l10n.lbl_*` keys
    - All common strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.2, 4.3_

- [x] 12. Update widgets to use centralized translations - Palakat Mobile
  - [x] 12.1 Update authentication screens to use l10n
    - Update PhoneInputScreen and OtpVerificationScreen to use `context.l10n.auth_*` keys
    - All auth strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.2, 4.3_
  - [x] 12.2 Update home screen to use l10n
    - Update HomeScreen and related widgets to use `context.l10n.nav_*`, `context.l10n.dashboard_*` keys
    - All home strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.1, 4.3_
  - [x] 12.3 Update common UI to use l10n
    - Update ScaffoldWidget and BottomNavBar to use `context.l10n.btn_*`, `context.l10n.lbl_*` keys
    - All common strings already defined in central ARB files (task 1.2)
    - _Requirements: 4.2, 4.3_

- [x] 13. Final Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.

