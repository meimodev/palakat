# Implementation Plan

- [x] 1. Extend Operations state and controller for supervised activities
  - [x] 1.1 Update OperationsState with supervised activities fields
    - Add `supervisedActivities`, `loadingSupervisedActivities`, `supervisedActivitiesError` fields
    - Run code generation with `derry gen`
    - _Requirements: 1.1, 4.1, 4.2_
  - [x] 1.2 Implement fetchSupervisedActivities in OperationsController
    - Use existing ActivityRepository.fetchActivities with membershipId filter
    - Limit to 3 most recent activities sorted by date descending
    - Handle loading and error states
    - _Requirements: 1.1, 4.1, 4.2_
  - [ ]* 1.3 Write property test for recent activities limit
    - **Property 1: Recent activities limit**
    - **Validates: Requirements 1.1**

- [x] 2. Create SupervisedActivitiesSection widget
  - [x] 2.1 Create supervised_activities_section_widget.dart
    - Display section header with "Supervised Activities" title and "See All" button
    - Show list of up to 3 activity items with title, date, and type
    - Handle loading state with shimmer placeholder
    - Handle error state with retry button
    - Hide section when activities list is empty
    - _Requirements: 1.1, 1.2, 1.3, 2.1, 4.1, 4.2_
  - [x] 2.2 Create supervised_activity_item_widget.dart
    - Display activity title, formatted date, and activity type badge
    - Handle tap to navigate to activity detail
    - _Requirements: 1.3, 1.4_
  - [ ]* 2.3 Write property test for activity item display completeness
    - **Property 2: Activity item display completeness**
    - **Validates: Requirements 1.3**
  - [ ]* 2.4 Write property test for navigation callback correctness
    - **Property 3: Navigation callback correctness**
    - **Validates: Requirements 1.4**

- [x] 3. Integrate SupervisedActivitiesSection into OperationsScreen
  - [x] 3.1 Add SupervisedActivitiesSection to OperationsScreen
    - Place section after PositionSummaryCard
    - Connect to controller state and callbacks
    - Wire up navigation to activity detail and list screens
    - _Requirements: 1.1, 1.4, 2.1, 2.2_
  - [x] 3.2 Add route for supervised activities list screen
    - Add route constant to AppRoute
    - Register route in GoRouter configuration
    - _Requirements: 2.2_

- [x] 4. Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.

- [x] 5. Create SupervisedActivitiesListScreen with state management
  - [x] 5.1 Create SupervisedActivitiesListState
    - Define state with activities list, pagination fields, and filter fields
    - Include hasActiveFilters computed property
    - Run code generation
    - _Requirements: 2.3, 3.1, 3.2, 3.5_
  - [x] 5.2 Create SupervisedActivitiesListController
    - Implement fetchActivities with pagination support
    - Implement loadMoreActivities for infinite scroll
    - Implement filter methods: setActivityTypeFilter, setDateRangeFilter, clearFilters
    - Use existing ActivityRepository with GetFetchActivitiesRequest
    - _Requirements: 2.3, 3.1, 3.2, 3.3, 3.4_
  - [ ]* 5.3 Write property test for filter application correctness
    - **Property 5: Filter application correctness**
    - **Validates: Requirements 3.3**
  - [ ]* 5.4 Write property test for filter clear restores full list
    - **Property 6: Filter clear restores full list**
    - **Validates: Requirements 3.4**
  - [ ]* 5.5 Write property test for active filter indicator consistency
    - **Property 7: Active filter indicator consistency**
    - **Validates: Requirements 3.5**

- [x] 6. Create SupervisedActivitiesListScreen UI
  - [x] 6.1 Create supervised_activities_list_screen.dart
    - Implement screen with filter bar and activity list
    - Add activity type dropdown filter
    - Add date range picker for start/end date filters
    - Show active filter indicator when filters applied
    - Implement pagination with load more on scroll
    - _Requirements: 2.3, 3.1, 3.2, 3.5_
  - [x] 6.2 Create supervised_activity_list_item_widget.dart
    - Display activity title, date, type, and approval status
    - Handle tap to navigate to activity detail
    - _Requirements: 2.4_
  - [ ]* 6.3 Write property test for list item display completeness
    - **Property 4: List item display completeness**
    - **Validates: Requirements 2.4**

- [x] 7. Implement empty and error states
  - [x] 7.1 Add empty state for filtered results
    - Display "No activities match your filters" message
    - Show clear filters button
    - _Requirements: 4.3_
  - [x] 7.2 Add error handling with retry
    - Display error message when fetch fails
    - Provide retry button
    - _Requirements: 4.2_

- [ ] 8. Final Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.
